from sklearn.ensemble import RandomForestClassifier as RF
from sklearn import cross_validation
from sklearn.metrics import confusion_matrix
import pandas as pd
import numpy as np


subtrainLabel = pd.read_csv('subtrainLabels.csv')
subtrainLabel_test = pd.read_csv('subtrainLabels_test.csv')

subtrainfeature = pd.read_csv("TFIDF_top50_3gramfeature.csv")
subtrainfeature_test = pd.read_csv('TFIDF_top50_3gramfeature_test.csv')

subtrain = pd.merge(subtrainLabel,subtrainfeature,on='Id')
subtrain_test = pd.merge(subtrainLabel_test,subtrainfeature_test,on='Id')

labels = subtrain.Class
labels_test = subtrain_test.Class

subtrain.drop(["Class","Id"], axis=1, inplace=True)
subtrain_test.drop(["Class","Id"], axis=1, inplace=True)

subtrain = subtrain.as_matrix()
subtrain_test = subtrain_test.as_matrix()

X_train = subtrain
y_train = labels
X_test = subtrain_test
y_test = labels_test

srf = RF(n_estimators=100, n_jobs=-1)
srf.fit(X_train,y_train)
print srf.score(X_test,y_test)

f1 = open('out_x_test_TFIDF_3-gram_top50.txt','w')
f2 = open('out_pridict_x_test_TFIDF_3-gram_top50.txt','w')
print >> f1,y_test
print >>f2,srf.predict(X_test)